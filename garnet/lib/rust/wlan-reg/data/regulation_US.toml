# Copyright 2019 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

version = "0.1.0" # Schema version
jurisdiction = "US"

# References
# 47 CFR 15.205 Frequency bands only for spurious emissions
# 47 CFR 15.207 Conducted limit (dBuV) Qausi-peak and Average
# 47 CFR 15.205 Radiated emission limits; general requirements
# 47 CFR 15.247 Operation within ISM bands
# 47 CFR 15.401
# 47 CFR 15.407(h)
# FCC KDB 905462 D02, D03, D04, D06, D07. Esp, see the rule after Aug 8 2015, for 905462 15.401
# FCC KDB 594280 D01

# Subband
# [{Beginning frequency in MHz}{dash}{Ending frequency in MHz}]
#[[subband]]
#    freq_beg = 5.350
#    freq_end = 5.460
#    do_not_use = true # Corresponds to channel 68 - 96. FCC CFR Subpart C 15.205


[[subband]]
    freq_beg = 2.400  # GHz
    freq_end = 2.4835 # GHz
    chan_idx_beg = 1  # TODO(porce): This is not universal. Consider referring to Operating Classes.
    chan_idx_end = 13

    is_indoor = true
    is_outdoor = true

    [[subband.role]]
        role = "any"
        # Summed across all antennas. 15.247.b.3. For up to 6 dBi antenna
        # See 15.247.c for variations.
        max_conduct_power = 30 # dBm. 1000 mWatts. Peak
        max_ant_gain = 6 # dBi  # For the stated max conducted power


[[subband]] # 15.407.a
    # Note the beginning frequency is _not_ 5.170 GHz, which corresponds to channel 36.
    freq_beg = 5.150
    freq_end = 5.250
    chan_idx_beg = 34
    chan_idx_end = 48

    is_indoor = true
    is_outdoor = true

    [[subband.role]]
        role = "indoor_ap"
        max_conduct_power = 30 # dBm. 1000 mWatts
        max_psd = 17 # dBm/MHz
        max_ant_gain = 6 # dBi
        max_eirp_30degree = 21 # dBm. 125 mWatts

    [[subband.role]]
        role = "outdoor_ap"
        max_conduct_power = 30 # dBm. 1000 mWatts
        max_psd = 17 # dBm/MHz
        max_ant_gain = 6 # dBi
        max_eirp_30degree = 21 # dBm. 125 mWatts

    [[subband.role]] # Note. This is for AP.
        role = "fixed_p2p_ap"
        max_conduct_power = 30 # dBm. 1000 mWatts
        max_psd = 17 # dBm/MHz
        max_ant_gain = 23 # dBi

    [[subband.role]]
        role = "client"
        max_conduct_power = 24 # dBm. 250 mWatts
        max_psd = 11 # dBm/MHz
        max_ant_gain = 6 # dBi


[[subband]] # FCC KDB905462 D02 v02

    freq_beg = 5.250
    freq_end = 5.350
    chan_idx_beg = 50 # Note Channel 50 overlaps with UNII-1 and UNII-2A both.
    chan_idx_end = 68

    is_indoor = true
    is_outdoor = true

    [subband.dfs]
        # See FCC KDB905462 D02 v02 Table 3.
        is_dfs = true
        dfs_detect_thresh = -64 # dBm for devices with maximum EIRP 23 ~ 30 dBm
        dfs_detect_thresh_for_lower_eirp = -62 # dBm for devices with max EIRP less than 23 dBm.

        dfs_channel_availability_check_time = 60000 # msec. 60 sec
        dfs_channel_move_time = 10000 # msec. 10 sec.
        dfs_channel_closing_tx_time = 200 # msec
        dfs_channel_closing_tx_time_leftover = 60 # msec for the remaining channel_move_time.
        dfs_non_occupancy_period = 1800000 # msec. 30 minutes

    [[subband.role]]
        role = "any"
        # or 11 dBm + 10 log B, where B is 26 dB emission bandwidth in MHz, whichever less.
        # At least 6 dB below the mean EIRP of 30 dBm.
        max_conduct_power = 24 # dBm. 250 mWatts
        max_psd = 11 # dBm/MHz
        max_ant_gain = 6 # dBi


[[subband]] # FCC KDB905462 D02 v02

    freq_beg = 5.470
    freq_end = 5.725
    chan_idx_beg = 96
    chan_idx_end = 142 # ish. Note Channel 142, 144 overlap with UNII-2C and UNII-3 both.

    is_indoor = true
    is_outdoor = true

    [subband.dfs]
        # See FCC KDB905462 D02 v02 Table 3.
        # Use the same values for subband 5250-5350 MHz. Double check with FCC.
        is_dfs = true
        dfs_detect_thresh = -64 # dBm for devices with maximum EIRP 23 ~ 30 dBm
        dfs_detect_thresh_for_lower_eirp = -62 # dBm for devices with max EIRP less than 23 dBm.

        dfs_channel_availability_check_time = 60000 # msec. 60 sec
        dfs_channel_move_time = 10000 # msec. 10 sec.
        dfs_channel_closing_tx_time = 200 # msec
        dfs_channel_closing_tx_time_leftover = 60 # msec for the remaining channel_move_time.
        dfs_non_occupancy_period = 1800000 # msec. 30 minutes

    [[subband.role]]
        role = "any"
        # 250 mWatts or 11 dBm + 10 log B, where B is 26 dB emission bandwidth in MHz, whichever less.
        max_conduct_power = 24 # dBm
        max_psd = 11 # dBm/MHz
        max_ant_gain = 6 # dBi


[[subband]]
    freq_beg = 5.725 # GHz
    freq_end = 5.850 # GHz
    chan_idx_beg = 144 # ish. Note Channel 142, 144 overlap with UNII-2C and UNII-3 both.
    chan_idx_end = 165

    is_indoor = true
    is_outdoor = true

    [[subband.role]]
        role = "any"
        max_conduct_power = 30 # dBm. 1000 mWatts. 15.247.b.3. For up to 6 dBi antenna
        max_psd = 33 # dBm/MHz. In the clause, 30 dBm in any 500 kHz band.
        max_ant_gain = 6 # dBi

    [[subband.role]] # Note. Not necessarily for AP.
        role = "fixed_p2p"
        max_conduct_power = 30 # dBm. 1000 mWatts. 15.247.b.3. For up to 6 dBi antenna
        max_psd = 33 # dBm/MHz. In the clause, 30 dBm in any 500 kHz band.
        max_ant_gain = 100 # dBi. No limit in the regulation. 100 is chosen arbitrarily large.
