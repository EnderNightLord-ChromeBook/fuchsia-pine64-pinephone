# Copyright 2019 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Proxy GN targets used to prepare for the migration of the Fuchsia tree
# to a newer upstream repository for spirv-tools.
#
# See https://fuchsia.atlassian.net/browse/MA-640 for details.

_legacy_dir = "//third_party/shaderc/third_party/spirv-tools"

config("spvtools_public_config") {
  include_dirs = [ "${_legacy_dir}/include" ]
}

group("spvtools_opt") {
  deps = [
    "${_legacy_dir}:spirv-tools-opt",
  ]
  public_configs = [ ":spvtools_public_config" ]
}

# The spirv-opt executable (host build only).
# This cannot be a group() because it is used in compiled_action()
# calls, so rebuild everything from sources from the legacy dir.
# This also means the legacy target needs to be renamed, otherwise
# GN will complain that two targets generate the same file!
executable("spirv-opt") {
  deps = [
    "${_legacy_dir}:spirv-deps",
    "${_legacy_dir}:spirv-tools",
    "${_legacy_dir}:spirv-tools-opt",
  ]
  sources = [
    "${_legacy_dir}/tools/opt/opt.cpp",
  ]
}

group("SPIRV-Tools") {
  public_deps = [
    "${_legacy_dir}:spirv-tools",
  ]
  public_configs = [ ":spvtools_public_config" ]
}

group("spvtools_headers") {
  public_configs = [ ":spvtools_public_config" ]
}
